(function(){"use strict";const c={activePicks:[],lastFetchedAt:null,isFetching:!1,sortColumn:"edge",sortDirection:"desc"},h={tbody:()=>document.getElementById("picks-tbody"),lastRefreshed:()=>document.querySelector("#ft-last-refreshed .sync-time")},y=()=>new Date().toISOString(),N=e=>{if(!e)return"";const s=new Date(e);if(Number.isNaN(s.getTime()))return String(e);const t=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");return`${t}/${a}`},o=e=>(e??"").toString(),u=e=>o(e).trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,40),m=e=>{const s=o(e).toUpperCase();return s==="NCAAM"||s==="NCAAB"?"NCAAB":s||"NBA"},k=e=>{const s=m(e.sport||e.league),t=(e.gameDate||e.date||"").toString().slice(0,10),a=u(e.awayTeam),n=u(e.homeTeam),r=u(e.pickType),l=u(e.segment),d=u(e.pickDirection||e.pickTeam||e.pick||""),i=u(e.line),f=`${s}-${t}-${a}-at-${n}-${r}-${l}-${d}-${i}`;return f.length<=255?f:f.slice(0,255)},p=(e,s="info")=>{if(window.showNotification){window.showNotification(e,s);return}try{const t=document.createElement("div");t.textContent=e,t.style.cssText="position:fixed;top:20px;right:20px;z-index:99999;padding:10px 14px;border-radius:10px;background:rgba(6,28,20,0.95);color:#e8f0f2;border:1px solid rgba(60,255,181,0.35);",document.body.appendChild(t),setTimeout(()=>t.remove(),2500)}catch{}},F=e=>{const s=h.lastRefreshed();if(!s)return;const t=new Date(e);if(Number.isNaN(t.getTime())){s.textContent="-";return}s.textContent=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},D=e=>{const s=m(e);return s==="NBA"?{src:"assets/nba-logo.png",alt:"NBA"}:s==="NCAAB"?{src:"assets/ncaam-logo.png",alt:"NCAAM"}:s==="NFL"?{src:"assets/nfl-logo.png",alt:"NFL"}:s==="NCAAF"?{src:"assets/ncaaf-logo.png",alt:"NCAAF"}:s==="NHL"?{src:"assets/icons/league-nhl.svg",alt:"NHL"}:{src:"",alt:s}},w=(e,s)=>{const t=m(s),a=t==="NCAAB"?"ncaam":t.toLowerCase(),n=window.SharedUtils?.getTeamAbbr?.(e)||o(e).split(" ").pop()||"",r=o(n).toLowerCase();return r?window.LogoLoader?.getLogoUrl?window.LogoLoader.getLogoUrl(a,r):`${(window.APP_CONFIG?.LOGO_BASE_URL||window.APP_CONFIG?.LOGO_FALLBACK_URL||"https://gbsvorchestratorstorage.blob.core.windows.net/team-logos").replace(/\/+$/,"")}/${a==="ncaam"||a==="ncaaf"?"ncaa":a}-500-${r}.png`:""},E=e=>{const s=Math.max(0,Math.min(5,parseInt(e,10)||0));return s<=0?"":"\u{1F525}".repeat(s)},L=e=>{const s=o(e.pickType||"").toLowerCase(),t=o(e.line);if(s==="total"){const a=o(e.pickDirection).toUpperCase();return`${a.includes("UNDER")?"Under":a.includes("OVER")?"Over":a} ${t}`.trim()}return s==="moneyline"||s==="ml"?`${o(e.pickTeam)} ML`.trim():`${o(e.pickTeam)} ${t}`.trim()},b=e=>{const s=h.tbody();s&&(s.innerHTML=`
      <tr class="empty-state-row">
        <td colspan="7" class="empty-state-cell">
          <div class="empty-state">
            <span class="empty-icon">\u{1F4CA}</span>
            <span class="empty-message">${o(e||"No picks")}</span>
          </div>
        </td>
      </tr>
    `)},P=(e=5)=>{const s=h.tbody();if(s){s.innerHTML="";for(let t=0;t<e;t++){const a=document.createElement("tr");a.className="skeleton-row",a.innerHTML=Array(7).fill('<td class="skeleton-cell"></td>').join(""),s.appendChild(a)}}},A=e=>{const s=h.tbody();if(s){if(!Array.isArray(e)||e.length===0){b("No picks fetched yet. Tap a league or Fetch All to load model predictions.");return}s.innerHTML="";for(const t of e){const a=m(t.sport||t.league),n=D(a),r=w(t.awayTeam,a),l=w(t.homeTeam,a),d=typeof t.edge=="number"?t.edge:parseFloat(String(t.edge||"").replace("%",""))||0,i=document.createElement("tr");i.className="pick-row",i.setAttribute("data-row-id",t.id),i.setAttribute("data-league",a);const f=t.gameDate||t.date,U=N(f),I=o(t.odds||"-110"),T=o(t.segment||"FG"),O=L(t);i.innerHTML=`
        <td class="col-datetime" data-label="Date/Time">
          <div class="datetime-cell">
            <div class="cell-date">${o(U)}</div>
            <div class="cell-time">${o(t.time||t.gameTime||"")}</div>
            <div class="cell-book">${o(t.source||t.model||"Model")}</div>
          </div>
        </td>
        <td class="center col-league" data-label="League">
          <div class="league-cell">
            ${n.src?`<img src="${n.src}" class="league-logo" alt="${n.alt}" loading="lazy" />`:o(n.alt)}
          </div>
        </td>
        <td class="col-matchup" data-label="Matchup">
          <div class="matchup-cell matchup-inline">
            <span class="team-line">
              ${r?`<img src="${r}" class="team-logo" alt="${o(t.awayTeam)}" loading="lazy" onerror="this.style.display='none'" />`:""}
              <span class="team-name-full">${o(t.awayTeam)}</span>
            </span>
            <span class="vs-divider">@</span>
            <span class="team-line">
              ${l?`<img src="${l}" class="team-logo" alt="${o(t.homeTeam)}" loading="lazy" onerror="this.style.display='none'" />`:""}
              <span class="team-name-full">${o(t.homeTeam)}</span>
            </span>
          </div>
        </td>
        <td class="center col-segment" data-label="Segment">
          <span class="segment-pill" data-segment="${u(T)}">${o(T)}</span>
        </td>
        <td class="col-pick" data-label="Pick">
          <div class="pick-inline">
            <span class="pick-team">${o(O)}</span>
            <span class="pick-odds">(${o(I)})</span>
          </div>
        </td>
        <td class="center col-edge" data-label="Edge">
          <span class="edge-badge">${d?`${d.toFixed(1)}%`:"-"}</span>
        </td>
        <td class="center col-fire" data-label="Fire">
          <span class="fire-cell" title="Fire rating">${E(t.fire)}</span>
        </td>
      `,s.appendChild(i)}}},$=(e,s)=>{switch(s){case"date":return e.gameDate||e.date||"";case"league":return m(e.sport||e.league);case"matchup":return`${o(e.awayTeam)} ${o(e.homeTeam)}`;case"segment":return o(e.segment);case"pick":return L(e);case"edge":return typeof e.edge=="number"?e.edge:parseFloat(String(e.edge||"").replace("%",""))||0;case"fire":return parseInt(e.fire,10)||0;default:return""}},v=(e,s,t)=>{const a=t==="asc"?1:-1;return[...e].sort((n,r)=>{const l=$(n,s),d=$(r,s);return typeof l=="number"&&typeof d=="number"?(l-d)*a:String(l).localeCompare(String(d))*a})},x=()=>{const e=document.querySelector(".fetch-picks-table thead");e&&e.addEventListener("click",s=>{const t=s.target.closest(".th-sort-btn");if(!t)return;const a=t.closest("th");if(!a)return;const n=a.getAttribute("data-sort");n&&(s.preventDefault(),c.sortColumn===n?c.sortDirection=c.sortDirection==="asc"?"desc":"asc":(c.sortColumn=n,c.sortDirection=n==="edge"||n==="fire"?"desc":"asc"),e.querySelectorAll("th").forEach(r=>{r.classList.remove("sorted-asc","sorted-desc")}),a.classList.add(c.sortDirection==="asc"?"sorted-asc":"sorted-desc"),c.activePicks=v(c.activePicks,c.sortColumn,c.sortDirection),A(c.activePicks))})},S=(e,s)=>{e&&(s?(e.classList.add("fetching"),e.disabled=!0):(e.classList.remove("fetching"),e.disabled=!1))},g=async(e,s)=>{if(!c.isFetching){if(!window.UnifiedPicksFetcher?.fetchPicks){p("Model fetchers not loaded yet \u2014 please wait","error");return}c.isFetching=!0,S(s,!0),P(6);try{const t=await window.UnifiedPicksFetcher.fetchPicks(e,"today",{skipCache:!0}),n=(Array.isArray(t?.picks)?t.picks:[]).map(d=>{const i={...d};return i.sport=m(i.sport||i.league),i.gameDate=(i.gameDate||i.date||y()).toString().slice(0,10),i.id=i.id||k(i),i}),r=v(n,c.sortColumn,c.sortDirection);c.activePicks=r,c.lastFetchedAt=y(),A(r),F(c.lastFetchedAt);const l=r.length;if(p(l>0?`Fetched ${l} pick${l!==1?"s":""}`:"No picks available right now",l>0?"success":"info"),t?.errors?.length){const d=t.errors.map(i=>i.league).join(", ");p(`Some leagues unavailable: ${d}`,"warning")}}catch(t){p(`Fetch failed: ${t.message||t}`,"error"),b("Unable to fetch picks. Please try again.")}finally{c.isFetching=!1,S(s,!1)}}},M=()=>{const e=document.querySelector(".filter-toolbar");e&&e.addEventListener("click",a=>{const n=a.target.closest("button[data-fetch]");if(!n||n.disabled)return;a.preventDefault();const r=o(n.getAttribute("data-fetch")).toLowerCase();r&&g(r==="ncaab"||r==="ncaam"?"ncaam":r==="all"?"all":r,n)});const s=document.getElementById("mobile-fetch-fab"),t=document.getElementById("mobile-fetch-menu");s&&t&&(s.addEventListener("click",a=>{a.preventDefault();const n=!t.hidden;t.hidden=n,s.setAttribute("aria-expanded",String(!n))}),t.addEventListener("click",a=>{const n=a.target.closest("button[data-fetch]");if(!n)return;a.preventDefault(),t.hidden=!0,s.setAttribute("aria-expanded","false");const r=o(n.getAttribute("data-fetch")).toLowerCase();r&&g(r==="ncaab"||r==="ncaam"?"ncaam":r==="all"?"all":r,null)}),document.addEventListener("click",a=>{!t.hidden&&!t.contains(a.target)&&a.target!==s&&(t.hidden=!0,s.setAttribute("aria-expanded","false"))}))},B=()=>{document.querySelectorAll(".ft-dropdown-btn").forEach(e=>{e.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();const t=e.nextElementSibling;if(!t)return;const a=t.classList.contains("open");document.querySelectorAll(".ft-dropdown-menu.open").forEach(n=>n.classList.remove("open")),a||t.classList.add("open")})}),document.addEventListener("click",e=>{e.target.closest(".ft-dropdown")||document.querySelectorAll(".ft-dropdown-menu.open").forEach(s=>s.classList.remove("open"))})};window.FetchPicks={getActivePicks(){return c.activePicks||[]},showNotification(e,s){p(e,s)},showEmptyState(e){b(e)}};const C=()=>{M(),x(),B()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",C):C()})();
//# sourceMappingURL=fetch-picks.min.js.map
