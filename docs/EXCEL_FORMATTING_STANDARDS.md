# Excel Formatting Standards

All Excel files generated by data-pipeline scripts **must** follow these formatting requirements to match the Bombay711 pick tracker style.

## Required Features

### 1. Structure
- **Frozen header row** (`ws.freeze_panes = "A2"`)
- **Auto-filter enabled** on all columns (sortable/filterable)
- **Table object** with `TableStyleMedium2` for enhanced filtering UX
- **Summary sheet** with aggregate stats by category
- **Metadata sheet** with generation timestamp and source info

### 2. Header Styling
```python
HEADER_FILL = PatternFill(start_color="1F4E79", end_color="1F4E79", fill_type="solid")  # Dark blue
HEADER_FONT = Font(name="Calibri", size=11, bold=True, color="FFFFFF")
```

### 3. Data Styling
```python
DATA_FONT = Font(name="Calibri", size=10)
ALTERNATING_FILL = PatternFill(start_color="D6E3F8", end_color="D6E3F8", fill_type="solid")  # Light blue
THIN_BORDER = Border(
    left=Side(style="thin", color="B4B4B4"),
    right=Side(style="thin", color="B4B4B4"),
    top=Side(style="thin", color="B4B4B4"),
    bottom=Side(style="thin", color="B4B4B4")
)
```

### 4. League Color Coding
For sports data, apply league-specific row colors:

| League | Color | Hex Code |
|--------|-------|----------|
| NBA | Light Orange | `#FDE9D9` |
| NCAAM | Light Green | `#EBF1DE` |
| NFL | Light Blue | `#DCE6F1` |
| NCAAF | Light Red | `#F2DCDB` |

```python
LEAGUE_COLORS = {
    "NBA": PatternFill(start_color="FDE9D9", end_color="FDE9D9", fill_type="solid"),
    "NCAAM": PatternFill(start_color="EBF1DE", end_color="EBF1DE", fill_type="solid"),
    "NFL": PatternFill(start_color="DCE6F1", end_color="DCE6F1", fill_type="solid"),
    "NCAAF": PatternFill(start_color="F2DCDB", end_color="F2DCDB", fill_type="solid"),
}
```

### 5. Alignment Rules
- **Numeric columns** (scores, IDs): Center aligned
- **Date/Status/League**: Center aligned  
- **Team names/Text**: Left aligned

### 6. Column Widths
Set explicit widths based on content type:

| Column Type | Width |
|-------------|-------|
| IDs | 12 |
| Short codes (team abbrev) | 10-12 |
| Full names | 25 |
| Dates | 12 |
| Timestamps | 20 |

## Dependencies
```bash
pip install openpyxl
```

## Reference Implementation
See `data-pipeline/scripts/generate_master_excel.py` for the canonical implementation.

## Output Locations

| File | Local Path | Azure Blob |
|------|-----------|-----------|
| Master Schedule | `data-pipeline/output/master_schedule_all_leagues.xlsx` | `metricstrackersgbsv/master-schedules/` |
| Pick Tracker | `client/assets/misc_data/20251222_bombay711_tracker_consolidated.xlsx` | â€” |
